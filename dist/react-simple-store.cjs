var t=require("react");const e=(e,r={},o={})=>{let s=!1,c={...r};const n=new Set,{allowNested:a=!0}=o,i=(t,e)=>{if(!a&&s)throw new Error("Nested state mutation disabled");try{s=!0;const r="function"==typeof t?t(c):t;if(!Object.is(r,c)){if("object"!=typeof r)throw new Error("next state not object");const t=c;c=e?r:{...c,...r},n.forEach(e=>e(c,t))}}finally{s=!1}},u=()=>c,l=t=>(n.add(t),()=>{n.delete(t)}),f=(t,e,r,o=t(c))=>{let s=o;return()=>{const o=t(c);(r?r(s,o):Object.is(s,o))||(e(o,s),s=o)}},d=function(){var t=[].slice.call(arguments);return l(t[1]?f(...t):t[0])};return{...e(i,u,{subscribe:d}),useStore:(e,r,o=!1)=>{const[{v:s,r:n},a]=t.useState({v:e(c),r:!!o});return t.useEffect(()=>{const t=f(e,t=>a({v:t,r:n}),r,s);return t(),l(t)},n?[e]:[]),s},getState:u,setState:i,destroy:()=>n.clear(),subscribe:d}};exports.createStore=e,exports.createStoreRedux=(t,r)=>e((e,r)=>({dispatch:o=>e(t(r(),o))}),r);
