var t=require("react");const e=(e,r={},n={})=>{let o=!1,c={...r};const s=new Set,{allowNested:a=!0}=n,u=(t,e)=>{if(!a&&o)throw new Error("Nested state mutation disabled");try{o=!0;const r="function"==typeof t?t(c):t;if(!Object.is(r,c)){if("object"!=typeof r)throw new Error("next state not object");const t=c;c=e?r:{...c,...r},s.forEach(e=>e(c,t))}}finally{o=!1}},i=()=>c,l=t=>(s.add(t),()=>{s.delete(t)}),f=(t,e,r,n=t(c))=>{let o=n;return()=>{const n=t(c);(r?r(o,n):Object.is(o,n))||(e(n,o),o=n)}},b=function(){var t=[].slice.call(arguments);return l(t[1]?f(...t):t[0])};return{...e(u,i,{subscribe:b}),useStore:(e,r,n=!1)=>{const[{v:o,r:s},a]=t.useState({v:e(c),r:!!n});return t.useEffect(()=>{const t=f(e,t=>a({v:t,r:s}),r,o);return t(),l(t)},s?[e]:[]),o},getState:i,setState:u,destroy:()=>s.clear(),subscribe:b}},r=(t,e)=>{if(Object.is(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;const o=Object.prototype.hasOwnProperty.bind(e);for(let n=0;n<r.length;n++){const c=r[n];if(!o(c)||!Object.is(t[c],e[c]))return!1}return!0};exports.createStore=e,exports.createStoreRedux=(n,o)=>{const c=e((t,e)=>({dispatch:r=>t(n(e(),r))}),o),{useStore:s,dispatch:a}=c;return c.connect=(e,n)=>o=>{const c=c=>{const u=s(e,r);return t.createElement(o,{...c,...u,...n(a)})};return c.displayName=`Connect(${o.displayName||o.name||"Component"})`,c},c};
