var e=require("react");const t=(t,r={},o={})=>{let s,c=!1,n={...r};const a=new Set,{allowNested:u=!0}=o,i=(e,t)=>{if(!u&&c)throw new Error("Nested state mutation disabled");try{c=!0;const r="function"==typeof e?e(n):e;if(!Object.is(r,n)){if("object"!=typeof r)throw new Error("next state not object");const e=n;n=t?r:{...n,...r},s=performance.now(),a.forEach(t=>t(n,e))}}finally{c=!1}},f=()=>n,l=e=>(a.add(e),()=>{a.delete(e)}),d=(e,t,r)=>{let o=e(n);return()=>{const s=e(n);(r?r(o,s):Object.is(o,s))||(t(s,o),o=s)}},b=function(){var e=[].slice.call(arguments);return l(e[1]?d(...e):e[0])};return{...t(i,f,{subscribe:b}),useStore:(t,r,o=!1)=>{const c=e.useRef([o,s]),[{v:a},u]=e.useState({v:t(n)}),[i,f]=c.current;return e.useEffect(()=>{const e=d(t,e=>u({v:e}),r);return f!==s&&e(),l(e)},i?[t]:[]),a},getState:f,setState:i,destroy:()=>a.clear(),subscribe:b}};exports.createStore=t,exports.createStoreRedux=(e,r)=>t((t,r)=>({dispatch:o=>(t(e(r(),o)),o)}),r);
