var t=require("react");const e=(e,r={},o={})=>{let s=!1,c={...r};const n=new Set,{allowNested:a=!0}=o,u=(t,e)=>{if(!a&&s)throw new Error("Nested state mutation disabled");try{s=!0;const r="function"==typeof t?t(c):t;if(!Object.is(r,c)){if("object"!=typeof r)throw new Error("next state not object");const t=c;c=e?r:{...c,...r},n.forEach(e=>e(c,t))}}finally{s=!1}},i=()=>c,l=t=>(n.add(t),()=>{n.delete(t)}),d=(t,e,r,o=t(c))=>{let s=o;return()=>{const o=t(c);(r?r(s,o):Object.is(s,o))||(e(o,s),s=o)}},f=function(){var t=[].slice.call(arguments);return l(t[1]?d(...t):t[0])};return{...e(u,i,{subscribe:f}),useStore:(e,r,o=!1)=>{const[{v:s,r:n},a]=t.useState({v:e(c),r:!!o});return t.useEffect(()=>{const t=d(e,t=>a({v:t,r:n}),r,s);return t(),l(t)},n?[e]:[]),s},getState:i,setState:u,destroy:()=>n.clear(),subscribe:f}};exports.createStore=e,exports.createStoreRedux=(r,o)=>{const s=e((t,e)=>({dispatch:o=>t(r(e(),o))}),o),{useStore:c,dispatch:n}=s;return s.connect=(e,r)=>o=>s=>{const a=c(e);return t.createElement(o,{...s,...a,...r(n)})},s};
